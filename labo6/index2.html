<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Labo 6 - Equipe 1</title>
</head>
<body>
<canvas style="margin: 10px;" width="800" height="600" id="canvas">

</canvas>
<h1>Rapport</h1>
<h2>Introduction</h2>
<p>Ce la boratoire a été réalisé dans le cadre du cours d'algorithmes numériques. Ce projet porte
sur les équations différentielles. Il a été demandé de pouvoir simuler un double pendule. Ce laboratoire a été réalisé en HTML5 et en JavaScript.</p>
<h2>Méthode de développement</h2>
<p></p>
<h2>Conclusion</h2>
<p></p>

<script>
    var canvas = document.getElementById("canvas");
    var context = canvas.getContext("2d");
	
	var d2ThetaP1=0;//Angle du 1er pendule de la 2eme derivé par rapport au temps
	var d2ThetaP2=0;//Angle du 2ème pendule de la 2eme derivé par rapport au temps
	var dThetaP1=0;//Angle du 1er pendule de la 1er derivé par rapport au temps
	var dThetaP2=0;//Angle du 2ème pendule de la 1er derivé par rapport au temps
	var ThetaP1=50/180*(Math.PI);//Angle du 1er pendule par rapport à l'axe x,-y
	var ThetaP2=65/180*(Math.PI);//Angle du 2ème pendule par rapport à l'axe x,-y
	var mP1=15;//Masse du pendule 1 qui sera le rayon du cercle
	var mP2=15;//Masse du pendule 2 qui sera le rayon du cercle
	var lP1=100;//longueur pendule 1
	var lP2=100;//longueur pendule 2
	var x0=canvas.width/2; //position x du double pendule (milieu du canvas)
	var y0=0;//position y double pendule
	var g=9.81;//gravité
	var time=0.05;//temps de départ
	
	var lineP1 = {x0: x0, y0: y0, x: 0, y: 0};
	var lineP2 = {x0: 0, y0: 0, x: 0, y: 0};
	var circleP1 = {x: x0+lP1*Math.sin(ThetaP1), y: y0+lP1*Math.cos(ThetaP1), m: mP1};
	var circleP2 = {x: x0+lP1*Math.sin(ThetaP1)+lP2*Math.sin(ThetaP2), y: y0+lP1*Math.cos(ThetaP1)+lP2*Math.cos(ThetaP2), m: mP2};
	
	function drawCircle(circle, context) {
		context.beginPath();
		//arc(x, y, r, angle, angle);
		context.arc(circle.x, circle.y, circle.m, 0, 2 * Math.PI);
		context.fillStyle='#000';
		context.fill();
		context.lineWidth = 3;
		context.strokeStyle = 'black';
		context.stroke();
	}

	function drawLine(line, context) {
		context.beginPath();
		context.moveTo(line.x0, line.y0);
		context.lineTo(line.x, line.y);
		context.strokeStyle = 'blue';
		context.stroke();
	}
	
	//Methode d'Euler
    setInterval(function(){
		mu=1+mP1/mP2;
		//On obtient ces angles en derivant le Lagrangian - calculs des nouveaux angles du pendule
		d2ThetaP1=(g*(Math.sin(ThetaP2)*Math.cos(ThetaP1-ThetaP2)-mu*Math.sin(ThetaP1))-(lP2*dThetaP2*dThetaP2+lP1*dThetaP1*dThetaP1*Math.cos(ThetaP1-ThetaP2))*Math.sin(ThetaP1-ThetaP2))/(lP1*(mu-Math.cos(ThetaP1-ThetaP2)*Math.cos(ThetaP1-ThetaP2)));
		d2ThetaP2=(mu*g*(Math.sin(ThetaP1)*Math.cos(ThetaP1-ThetaP2)-Math.sin(ThetaP2))+(mu*lP1*dThetaP1*dThetaP1+lP2*dThetaP2*dThetaP2*Math.cos(ThetaP1-ThetaP2))*Math.sin(ThetaP1-ThetaP2))/(lP2*(mu-Math.cos(ThetaP1-ThetaP2)*Math.cos(ThetaP1-ThetaP2)));
		//Euler
		dThetaP1+=d2ThetaP1*time;
		dThetaP2+=d2ThetaP2*time;
		ThetaP1+=dThetaP1*time;
		ThetaP2+=dThetaP2*time;

		//On redefinit les positions par rapport aux nouvelles angles calculés à l'instant t
		circleP1.x=x0+lP1*Math.sin(ThetaP1);
		circleP1.y=y0+lP1*Math.cos(ThetaP1);
		circleP2.x=x0+lP1*Math.sin(ThetaP1)+lP2*Math.sin(ThetaP2);
		circleP2.y=y0+lP1*Math.cos(ThetaP1)+lP2*Math.cos(ThetaP2);

		lineP1.x=circleP1.x;
		lineP1.y=circleP1.y;
		lineP2.x0=circleP1.x;
		lineP2.y0=circleP1.y;
		lineP2.x=circleP2.x;
		lineP2.y=circleP2.y;

		context.clearRect(0, 0, canvas.width, canvas.height);

		drawLine(lineP1, context);
		drawLine(lineP2, context);
		drawCircle(circleP1, context);
		drawCircle(circleP2, context);
	}, 0);


</script></body>
